@model List<Sinema_Dunyasi.Models.Domain.CartItem>
@{
    ViewBag.Title = "Ödeme sayfası";
    var successMessage = TempData["SuccessMessage"] as string; // Başarı mesajını al
    var total = TempData["Total"] as decimal? ?? 0; // Toplam tutarı al
}

@* -------------   Client side validation 12 ------- *@

@if (!string.IsNullOrEmpty(successMessage))
{
        <div class="alert alert-success" >
            <strong>@successMessage</strong>
        </div>
}
<form id="paymentForm" class="payment-form">
    <div class="form-group">
        <label for="cardNumber" class="form-label">Kart Numarası</label>
        <input type="text" id="cardNumber" name="cardNumber" class="form-input" required maxlength="16" pattern="^\d{16}$" title="Kart numarası tam olarak 16 rakamlı olmalıdır." />
    </div>
    <div class="form-group">
        <label for="expiryDate" class="form-label">Son Kullanma Tarihi</label>
        <input type="text" id="expiryDate" name="expiryDate" class="form-input" placeholder="AA/YY" required maxlength="5" pattern="^(0[1-9]|1[0-2])\/[0-9]{2}$" title="Son kullanma tarihi AA/YY formatında olmalıdır." />
    </div>
    <div class="form-group">
        <label for="cvv" class="form-label">CVV</label>
        <input type="text" id="cvv" name="cvv" class="form-input" required maxlength="3" pattern="^\d{3}$" title="CVV tam olarak 3 rakamlı olmalıdır." />
    </div>
    <button type="submit" class="form-submit-btn">
        Ödeme Yap
    </button>
</form>
<div id="message" class="alert" style="display:none; background-color: #e6f9e6; border: 1px solid #8fd88f; color: #2c662d; border-radius: 5px; padding: 10px; margin-top: 10px;">
    <strong>Alışveriş Sepetiniz tam boş oldu!</strong> Ödemeniz başarıyla alındı.
</div>

<div id="continueButton" style="display:none; margin-top: 10px;">
    <form action="@Url.Action("ClearCart", "Cart")" method="post">
        <button type="submit" style="background-color: #336699; color: #fff; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">
            Alışverişe Devam Et
        </button>
    </form>
</div>

<script>
    document.getElementById('paymentForm').addEventListener('submit', function (event) {
        event.preventDefault();
        var cardNumber = document.getElementById('cardNumber').value;
        var expiryDate = document.getElementById('expiryDate').value;
        var cvv = document.getElementById('cvv').value;
        var isPaymentSuccessful = true;
        var messageElement = document.getElementById('message');
        var continueButtonElement = document.getElementById('continueButton');

        if (isPaymentSuccessful) {
            messageElement.innerHTML = '<strong> Ödemeniz başarıyla alındı.</strong>';
            messageElement.style.display = 'block';
            continueButtonElement.style.display = 'block';
        } else {
            messageElement.className = 'alert';
            messageElement.innerHTML = '<strong>Ödeme Başarısız!</strong> Lütfen bilgilerinizi kontrol edip tekrar deneyin.';
            messageElement.style.backgroundColor = '#f8d7da';
            messageElement.style.border = '1px solid #f5c6cb';
            messageElement.style.color = '#721c24';
            messageElement.style.display = 'block';
        }
    });
</script>